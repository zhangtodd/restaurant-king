<!DOCTYPE html>
<html>

<head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width,initial-scale=1,shrink-to-fit=no">
    <title>é¤é¦†ç‹ - ç‚¹é¤å¹³å°</title>
    <link href="./assets/bootstrap/css/bootstrap.min.css" rel="stylesheet" type="text/css">
    <link href="./assets/animate.css/animate.min.css" rel="stylesheet" type="text/css">
    <link href="./assets/fontawesome/css/all.min.css" rel="stylesheet" type="text/css">
    <link href="./assets/slick/slick.css" rel="stylesheet" type="text/css">
    <link href="https://fonts.googleapis.com/css2?family=Rubik:wght@400;500;700&display=swap" rel="stylesheet"
          type="text/css">
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600;700&display=swap" rel="stylesheet"
          type="text/css">
    <link href="./assets/css/theme.min.css" rel="stylesheet" type="text/css">
</head>

<body class="body">
<div class="page-loader cube-loader">
    <div class="loader-wrap">
        <div class="loader-1 loader-element"></div>
        <div class="loader-2 loader-element"></div>
        <div class="loader-4 loader-element"></div>
        <div class="loader-3 loader-element"></div>
    </div>
</div>
<header class="header-colorfull header-horizontal header-over header-view-side">
    <div class="container">
        <!-- navbar -->
        <nav class="navbar">
            <div class="z-index-4 position-relative text-center">
                <h1 class="section-title" style="color: white">é¤é¦†ç‹ğŸ‘‘- RESTAURANT KING Â®</h1>
                <h3></h3>
            </div>

            <header class="header-white-color header-horizontal header-over header-view-side">
                <div class="container">
                    <nav class="navbar">

                        <button class="navbar-toggler" type="button">
                            <i class="fas fa-bars nav-show"></i>
                            <i class="fas fa-times nav-hide"></i>
                        </button>

                        <div class="navbar-collapse">
                            <div class="container">
                                <div class="navbar-extra">
                                    <ul class="actions-nav row">
                                        <li class="nav-item">
                                            <a class="nav-link" href="#">
                                                <i class="fas fa-user"></i>&nbsp;&nbsp;ç™»å½•
                                            </a>
                                        </li>
                                        <li class="nav-item">
                                            <a class="nav-link" href="cart.html">
                                                <i class="fas fa-shopping-bag"></i> æˆ‘çš„è´­ç‰©è½¦
                                                <span class="navbar-mobile">&nbsp;&nbsp;Cart</span>
                                                <span class="cart-quantity"></span>
                                            </a>
                                        </li>
                                    </ul>
                                </div>
                            </div>
                        </div>

                    </nav>
                </div>
            </header>

        </nav>
    </div>
</header>
<section class="after-head top-block-page with-back white-curve-after section-white-text">
    <div class="overflow-back bg-theme"></div>
    <div class="content-offs-stick my-5 container">
    </div>
</section>
<div class="container">
    <div class="sidebar-container">

        <!--right sidebar-->
        <div class="sidebar section order-lg-last">
            <!--search-->
            <section class="section-sidebar">
                <div class="section-head">
                    <h3 class="section-title h4">
                        <span>æœç´¢èœå“</span></h3>
                </div>
                <form autocomplete="off">
                    <div class="row">
                        <div class="col">
                            <div class="input-view-flat input-gray-shadow form-group">
                                <div class="input-group">
                                    <input class="form-control" id="search-keyword" name="search" type="text"
                                           placeholder="ä»Šå¤©æƒ³åƒç‚¹ä»€ä¹ˆ"
                                           style="color: #9d9d9d" required="required">
                                </div>
                            </div>
                        </div>
                        <div class="col-auto">
                            <button class="mb-0 btn btn-theme" type="button" id="search">
                                <i class="fas fa-search"></i>
                            </button>
                        </div>
                    </div>
                </form>
            </section>
            <!--select type-->
            <section class="section-sidebar">
                <div class="section-head">
                    <h3 class="section-title h4">
                        <span>é€‰æ‹©èœç³»</span></h3>
                </div>
                <ul class="list-unstyled" id="food-type-list">
                    <li>
                        <a class="record-line" href="" onclick="findByType()">
                            <span class="record-title" style="font-size:20px">å…¨éƒ¨</span>
                        </a>
                    </li>
                    <li>
                        <a class="record-line" href="#">
                            <span class="record-title" style="font-size:20px">ç²¤èœ</span>
                        </a>
                    </li>
                    <li>
                        <a class="record-line" href="#">
                            <span class="record-title" style="font-size:20px">å·èœ</span>
                        </a>
                    </li>
                    <li>
                        <a class="record-line" href="blog-sidebar-right.html">
                            <span class="record-title" style="font-size:20px">æ­å¸®èœ</span>
                        </a>
                    </li>

                </ul>
            </section>
        </div>
        <!--food list-->
        <div class="content">
            <section class="section">
                <div class="grid row" id="food-list-box">
                    <!-- Single product card-->
                    <div class="col-12 col-lg-6 d-flex">
                        <article class="entity-block entity-hover-shadow">
                            <a class="entity-preview-show-up entity-preview">
                                <span class="embed-responsive embed-responsive-4by3">
                                <img class="embed-responsive-item"
                                     src="https://www.hualigs.cn/image/601ab4cc62191.jpg" alt="">
                                </span>
                            </a>
                            <div class="fill-color-line" data-role="fill-line">
                                <div class="opacity-30 fill-line-segment bg-theme" data-role="fill-line-segment"
                                     data-min-width="10" data-preffered-width="50" data-max-width="80"></div>
                                <div class="opacity-60 fill-line-segment bg-theme" data-role="fill-line-segment"
                                     data-min-width="10" data-preffered-width="50" data-max-width="80"></div>
                                <div class="fill-line-segment bg-theme" data-role="fill-line-segment"
                                     data-min-width="10" data-preffered-width="50" data-max-width="80"></div>
                            </div>
                            <div class="entity-content">
                                <h4 class="entity-title"><a class="content-link">é’æ¤’</a></h4>
                                <p class="entity-text">
                                    é’æ¤’ç”±åŸäº§ä¸­å—ç¾æ´²çƒ­å¸¦åœ°åŒºçš„è¾£æ¤’åœ¨åŒ—ç¾æ¼”åŒ–è€Œæ¥ï¼Œé’æ¤’è¥å…»ä¸°å¯Œï¼Œè¾£å‘³è¾ƒæ·¡ä¹ƒè‡³æ ¹æœ¬ä¸è¾£ï¼Œ
                                    ä½œè”¬èœé£Ÿç”¨è€Œä¸æ˜¯ä½œä¸ºè°ƒå‘³æ–™ã€‚å®ƒé’è‘±ä¼˜ç¾ï¼Œæœ‰å„ç§å˜å¼‚å“ç§ï¼Œæœ‰é»„è‰²ï¼Œç»¿è‰²ï¼Œçº¢è‰²ç­‰ã€‚
                                </p>
                                <div class="entity-bottom-line">
                                    <div class="entity-price">
                                        <span class="currency">Â¥</span>3.50
                                    </div>
                                    <div class="entity-action-btns">
                                        <a class="btn-sm btn btn-theme" href="#">åŠ å…¥é¤è½¦</a></div>
                                </div>
                            </div>
                        </article>
                    </div>
                    <div class="col-12 col-lg-6 d-flex">
                        <article class="entity-block entity-hover-shadow">
                            <a class="entity-preview-show-up entity-preview">
                                <span class="embed-responsive embed-responsive-4by3">
                                <img class="embed-responsive-item"
                                     src="https://www.hualigs.cn/image/601ab4cc62191.jpg" alt="">
                                </span>
                            </a>
                            <div class="fill-color-line" data-role="fill-line">
                                <div class="opacity-30 fill-line-segment bg-theme" data-role="fill-line-segment"
                                     data-min-width="10" data-preffered-width="50" data-max-width="80"></div>
                                <div class="opacity-60 fill-line-segment bg-theme" data-role="fill-line-segment"
                                     data-min-width="10" data-preffered-width="50" data-max-width="80"></div>
                                <div class="fill-line-segment bg-theme" data-role="fill-line-segment"
                                     data-min-width="10" data-preffered-width="50" data-max-width="80"></div>
                            </div>
                            <div class="entity-content">
                                <h4 class="entity-title"><a class="content-link">é’æ¤’</a></h4>
                                <p class="entity-text">
                                    é’æ¤’ç”±åŸäº§ä¸­å—ç¾æ´²çƒ­å¸¦åœ°åŒºçš„è¾£æ¤’åœ¨åŒ—ç¾æ¼”åŒ–è€Œæ¥ï¼Œé’æ¤’è¥å…»ä¸°å¯Œï¼Œè¾£å‘³è¾ƒæ·¡ä¹ƒè‡³æ ¹æœ¬ä¸è¾£ï¼Œ
                                    ä½œè”¬èœé£Ÿç”¨è€Œä¸æ˜¯ä½œä¸ºè°ƒå‘³æ–™ã€‚å®ƒé’è‘±ä¼˜ç¾ï¼Œæœ‰å„ç§å˜å¼‚å“ç§ï¼Œæœ‰é»„è‰²ï¼Œç»¿è‰²ï¼Œçº¢è‰²ç­‰ã€‚
                                </p>
                                <div class="entity-bottom-line">
                                    <div class="entity-price">
                                        <span class="currency">Â¥</span>3.50
                                    </div>
                                    <div class="entity-action-btns">
                                        <a class="btn-sm btn btn-theme" href="#">åŠ å…¥é¤è½¦</a></div>
                                </div>
                            </div>
                        </article>
                    </div>
                    <div class="col-12 col-lg-6 d-flex">
                        <article class="entity-block entity-hover-shadow">
                            <a class="entity-preview-show-up entity-preview">
                                <span class="embed-responsive embed-responsive-4by3">
                                <img class="embed-responsive-item"
                                     src="https://www.hualigs.cn/image/601ab4cc62191.jpg" alt="">
                                </span>
                            </a>
                            <div class="fill-color-line" data-role="fill-line">
                                <div class="opacity-30 fill-line-segment bg-theme" data-role="fill-line-segment"
                                     data-min-width="10" data-preffered-width="50" data-max-width="80"></div>
                                <div class="opacity-60 fill-line-segment bg-theme" data-role="fill-line-segment"
                                     data-min-width="10" data-preffered-width="50" data-max-width="80"></div>
                                <div class="fill-line-segment bg-theme" data-role="fill-line-segment"
                                     data-min-width="10" data-preffered-width="50" data-max-width="80"></div>
                            </div>
                            <div class="entity-content">
                                <h4 class="entity-title"><a class="content-link">é’æ¤’</a></h4>
                                <p class="entity-text">
                                    é’æ¤’ç”±åŸäº§ä¸­å—ç¾æ´²çƒ­å¸¦åœ°åŒºçš„è¾£æ¤’åœ¨åŒ—ç¾æ¼”åŒ–è€Œæ¥ï¼Œé’æ¤’è¥å…»ä¸°å¯Œï¼Œè¾£å‘³è¾ƒæ·¡ä¹ƒè‡³æ ¹æœ¬ä¸è¾£ï¼Œ
                                    ä½œè”¬èœé£Ÿç”¨è€Œä¸æ˜¯ä½œä¸ºè°ƒå‘³æ–™ã€‚å®ƒé’è‘±ä¼˜ç¾ï¼Œæœ‰å„ç§å˜å¼‚å“ç§ï¼Œæœ‰é»„è‰²ï¼Œç»¿è‰²ï¼Œçº¢è‰²ç­‰ã€‚
                                </p>
                                <div class="entity-bottom-line">
                                    <div class="entity-price">
                                        <span class="currency">Â¥</span>3.50
                                    </div>
                                    <div class="entity-action-btns">
                                        <a class="btn-sm btn btn-theme" href="#">åŠ å…¥é¤è½¦</a></div>
                                </div>
                            </div>
                        </article>
                    </div>
                </div>
                <!-- åˆ†é¡µ -->
                <!--                <div class="section-footer">-->
                <!--                    <div class="paginator">-->
                <!--                        <a class="paginator-nav" href="#">-->
                <!--                            <i class="fas fa-arrow-left"></i>-->
                <!--                        </a>-->
                <!--                        <a class="paginator-item" href="#">1</a>-->
                <!--                        <span class="active paginator-item">2</span>-->
                <!--                        <a class="paginator-item" href="#">3</a>-->
                <!--                        <a class="paginator-nav" href="#">-->
                <!--                            <i class="fas fa-arrow-right"></i>-->
                <!--                        </a>-->
                <!--                    </div>-->
                <!--                </div>-->
            </section>
        </div>

    </div>
</div>
<div class="scroll-top">
    <i class="fas fa-long-arrow-alt-up"></i>
</div>

<script src="./assets/jquery/jquery-3.3.1.min.js"></script>
<script src="./assets/bootstrap/js/bootstrap.min.js"></script>
<script src="./assets/shuffle/shuffle.min.js"></script>
<script src="./assets/waypoints/jquery.waypoints.min.js"></script>
<script src="./assets/slick/slick.min.js"></script>
<script src="./assets/js-cookie/js.cookie.js" type="text/javascript"></script>
<script src="./assets/js/gmap/silver.js"></script>
<script src="./assets/js/script.js"></script>
<script src="../backend/js/my-utils.js"></script>

<script>

    const reloadTable = function (data) {
        const foodListBox = $("#food-list-box");
        $("#food-list-box > div").remove();
        data.forEach(function (item, index) {
            const price = intToDouble(item.price);
            //format: id.name.price.num.amount
            const obj = item.id + "." + item.name + "." + item.price;
            foodListBox.append(
                `<div class="col-12 col-lg-6 d-flex">
                    <article class="entity-block entity-hover-shadow">
                        <a class="entity-preview-show-up entity-preview">
                            <span class="embed-responsive embed-responsive-4by3">
                            <img class="embed-responsive-item"
                                 src="https://www.hualigs.cn/image/601ab4cc62191.jpg" alt="">
                            </span>
                        </a>
                        <div class="fill-color-line" data-role="fill-line">
                            <div class="opacity-30 fill-line-segment bg-theme" data-role="fill-line-segment"
                                 data-min-width="10" data-preffered-width="50" data-max-width="80"></div>
                            <div class="opacity-60 fill-line-segment bg-theme" data-role="fill-line-segment"
                                 data-min-width="10" data-preffered-width="50" data-max-width="80"></div>
                            <div class="fill-line-segment bg-theme" data-role="fill-line-segment"
                                 data-min-width="10" data-preffered-width="50" data-max-width="80"></div>
                        </div>
                        <div class="entity-content">
                            <h4 class="entity-title"><a class="content-link" id="${item.id}" name="${obj}">${item.name}</a></h4>
                            <p class="entity-text">
                                ${item.description}
                            </p>
                            <div class="entity-bottom-line">
                                <div class="entity-price">
                                    <span class="currency">Â¥</span>${price}
                                </div>
                                <div class="entity-action-btns">
                                    <a class="btn-sm btn btn-theme" href="javascript:;" onclick="addCart(${item.id})">åŠ å…¥é¤è½¦</a></div>
                            </div>
                        </div>
                    </article>
                </div>`
            );
        })
    };

    const reloadSelect = function (data) {
        const typeList = $("#food-type-list");
        $("#food-type-list > li").remove();
        typeList.append(
            `<li>
                <a class="record-line" href="#" onclick="findByType(0)">
                    <span class="record-title" style="font-size:20px">å…¨éƒ¨</span>
                </a>
            </li>`
        );
        data.forEach(function (item, index) {
            typeList.append(
                `<li>
                    <a class="record-line" onclick="findByType(${item.id})" type="button">
                        <span class="record-title" style="font-size:20px">${item.name}</span>
                    </a>
                </li>`
            )
        })
    };

    function findByType(typeId) {
        $.get("/food", {"method": "findByTypeId", "typeId": typeId}, function (data) {
            reloadTable(data);
        }, "json");
    }

    $(function () {
        $.get("/food", function (data) {
            reloadTable(data);
        }, "json");
        $.get("/food-type", function (data) {
            reloadSelect(data);
        }, "json");
    });

    $("#search").click(function () {
        const keyword = $("#search-keyword").val();
        $.get("/food", {"method": "search", "keyword": keyword}, function (data) {
            reloadTable(data);
        }, "json");
    });

    function addCart(id) {
        console.log(id);
        const tdDom = document.getElementById(id);
        const obj = tdDom.getAttribute("name");
        console.log(obj);

        // const objectResult = {}
        // result1.forEach(item => {
        //     objectResult[item[0]] = item[1];
        // });
        // console.log(objectResult);
        // if(localStorage.getItem("result")){
        //     let result = localStorage.getItem("result");
        //     // result.push(objectResult);
        // localStorage.setItem("result", result);
        // }

        const addFood = strToObj(obj);
        addFood.num = 1;
        addFood.amount = addFood.num * addFood.price;

        let cartStr = localStorage.getItem("cart");
        let cartObj;
        const foodId = addFood.id;
        if (cartStr) {
            //sessionä¸­å­˜åœ¨cart
            cartObj = strToObjDict(cartStr);
            if (cartObj[foodId]) {
                cartObj[foodId].num++;
                cartObj[foodId].amount += cartObj[foodId].price;
            } else {
                cartObj[id] = addFood;
            }
        } else {
            //sessionä¸­ä¸å­˜åœ¨cart
            cartObj = {};
            cartObj[foodId] = addFood;

        }
        console.log(objDictToStr(cartObj));

        localStorage.setItem("cart", objDictToStr(cartObj));

    }


</script>


</body>

</html>