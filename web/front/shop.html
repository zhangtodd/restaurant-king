<!DOCTYPE html>
<html>

<head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width,initial-scale=1,shrink-to-fit=no">
    <title>餐馆王 - 点餐平台</title>
    <link href="./assets/bootstrap/css/bootstrap.min.css" rel="stylesheet" type="text/css">
    <link href="./assets/animate.css/animate.min.css" rel="stylesheet" type="text/css">
    <link href="./assets/fontawesome/css/all.min.css" rel="stylesheet" type="text/css">
    <link href="./assets/slick/slick.css" rel="stylesheet" type="text/css">
    <link href="https://fonts.googleapis.com/css2?family=Rubik:wght@400;500;700&display=swap" rel="stylesheet"
          type="text/css">
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600;700&display=swap" rel="stylesheet"
          type="text/css">
    <link href="./assets/css/theme.min.css" rel="stylesheet" type="text/css">
</head>

<body class="body">
<div class="page-loader cube-loader">
    <div class="loader-wrap">
        <div class="loader-1 loader-element"></div>
        <div class="loader-2 loader-element"></div>
        <div class="loader-4 loader-element"></div>
        <div class="loader-3 loader-element"></div>
    </div>
</div>
<header class="header-colorfull header-horizontal header-over header-view-side">
    <div class="container">
        <!-- navbar -->
        <nav class="navbar">
            <div class="z-index-4 position-relative text-center">
                <h1 class="section-title" style="color: white">餐馆王👑- RESTAURANT KING ®</h1>
                <h3></h3>
            </div>
            <div class="navbar-collapse">
                <div class="container">
                    <div class="navbar-extra">
                        <ul class="actions-nav">
                            <li class="nav-item">
                                <a class="nav-link" href="#">
                                    <i class="fas fa-user"></i>&nbsp;&nbsp;登录
                                </a>
                            </li>
                            <li class="nav-item">
                                <a class="nav-link" href="cart.html">
                                    <i class="fas fa-shopping-bag"></i> 我的购物车
                                    <span class="navbar-mobile">&nbsp;&nbsp;Cart</span>
                                    <span class="cart-quantity"></span>
                                </a>
                            </li>
                        </ul>
                    </div>
                </div>
            </div>
        </nav>
    </div>
</header>
<section class="after-head top-block-page with-back white-curve-after section-white-text">
    <div class="overflow-back bg-theme"></div>
    <div class="content-offs-stick my-5 container">
    </div>
</section>
<div class="container">
    <div class="sidebar-container">
        <div class="content">
            <section class="section">
                <div class="grid row" id="food-list-box">
                    <!-- Single product card-->
                    <div class="col-12 col-lg-6 d-flex">
                        <article class="entity-block entity-hover-shadow">
                            <a class="entity-preview-show-up entity-preview">
                                <span class="embed-responsive embed-responsive-4by3">
                                <img class="embed-responsive-item"
                                     src="https://www.hualigs.cn/image/601ab4cc62191.jpg" alt="">
                                </span>
                            </a>
                            <div class="fill-color-line" data-role="fill-line">
                                <div class="opacity-30 fill-line-segment bg-theme" data-role="fill-line-segment"
                                     data-min-width="10" data-preffered-width="50" data-max-width="80"></div>
                                <div class="opacity-60 fill-line-segment bg-theme" data-role="fill-line-segment"
                                     data-min-width="10" data-preffered-width="50" data-max-width="80"></div>
                                <div class="fill-line-segment bg-theme" data-role="fill-line-segment"
                                     data-min-width="10" data-preffered-width="50" data-max-width="80"></div>
                            </div>
                            <div class="entity-content">
                                <h4 class="entity-title"><a class="content-link">青椒</a></h4>
                                <p class="entity-text">
                                    青椒由原产中南美洲热带地区的辣椒在北美演化而来，青椒营养丰富，辣味较淡乃至根本不辣，
                                    作蔬菜食用而不是作为调味料。它青葱优美，有各种变异品种，有黄色，绿色，红色等。
                                </p>
                                <div class="entity-bottom-line">
                                    <div class="entity-price">
                                        <span class="currency">¥</span>3.50
                                    </div>
                                    <div class="entity-action-btns">
                                        <a class="btn-sm btn btn-theme" href="#">加入餐车</a></div>
                                </div>
                            </div>
                        </article>
                    </div>
                    <div class="col-12 col-lg-6 d-flex">
                        <article class="entity-block entity-hover-shadow">
                            <a class="entity-preview-show-up entity-preview">
                                <span class="embed-responsive embed-responsive-4by3">
                                <img class="embed-responsive-item"
                                     src="https://www.hualigs.cn/image/601ab4cc62191.jpg" alt="">
                                </span>
                            </a>
                            <div class="fill-color-line" data-role="fill-line">
                                <div class="opacity-30 fill-line-segment bg-theme" data-role="fill-line-segment"
                                     data-min-width="10" data-preffered-width="50" data-max-width="80"></div>
                                <div class="opacity-60 fill-line-segment bg-theme" data-role="fill-line-segment"
                                     data-min-width="10" data-preffered-width="50" data-max-width="80"></div>
                                <div class="fill-line-segment bg-theme" data-role="fill-line-segment"
                                     data-min-width="10" data-preffered-width="50" data-max-width="80"></div>
                            </div>
                            <div class="entity-content">
                                <h4 class="entity-title"><a class="content-link">青椒</a></h4>
                                <p class="entity-text">
                                    青椒由原产中南美洲热带地区的辣椒在北美演化而来，青椒营养丰富，辣味较淡乃至根本不辣，
                                    作蔬菜食用而不是作为调味料。它青葱优美，有各种变异品种，有黄色，绿色，红色等。
                                </p>
                                <div class="entity-bottom-line">
                                    <div class="entity-price">
                                        <span class="currency">¥</span>3.50
                                    </div>
                                    <div class="entity-action-btns">
                                        <a class="btn-sm btn btn-theme" href="#">加入餐车</a></div>
                                </div>
                            </div>
                        </article>
                    </div>
                    <div class="col-12 col-lg-6 d-flex">
                        <article class="entity-block entity-hover-shadow">
                            <a class="entity-preview-show-up entity-preview">
                                <span class="embed-responsive embed-responsive-4by3">
                                <img class="embed-responsive-item"
                                     src="https://www.hualigs.cn/image/601ab4cc62191.jpg" alt="">
                                </span>
                            </a>
                            <div class="fill-color-line" data-role="fill-line">
                                <div class="opacity-30 fill-line-segment bg-theme" data-role="fill-line-segment"
                                     data-min-width="10" data-preffered-width="50" data-max-width="80"></div>
                                <div class="opacity-60 fill-line-segment bg-theme" data-role="fill-line-segment"
                                     data-min-width="10" data-preffered-width="50" data-max-width="80"></div>
                                <div class="fill-line-segment bg-theme" data-role="fill-line-segment"
                                     data-min-width="10" data-preffered-width="50" data-max-width="80"></div>
                            </div>
                            <div class="entity-content">
                                <h4 class="entity-title"><a class="content-link">青椒</a></h4>
                                <p class="entity-text">
                                    青椒由原产中南美洲热带地区的辣椒在北美演化而来，青椒营养丰富，辣味较淡乃至根本不辣，
                                    作蔬菜食用而不是作为调味料。它青葱优美，有各种变异品种，有黄色，绿色，红色等。
                                </p>
                                <div class="entity-bottom-line">
                                    <div class="entity-price">
                                        <span class="currency">¥</span>3.50
                                    </div>
                                    <div class="entity-action-btns">
                                        <a class="btn-sm btn btn-theme" href="#">加入餐车</a></div>
                                </div>
                            </div>
                        </article>
                    </div>
                </div>
                <!-- 分页 -->
                <!--                <div class="section-footer">-->
                <!--                    <div class="paginator">-->
                <!--                        <a class="paginator-nav" href="#">-->
                <!--                            <i class="fas fa-arrow-left"></i>-->
                <!--                        </a>-->
                <!--                        <a class="paginator-item" href="#">1</a>-->
                <!--                        <span class="active paginator-item">2</span>-->
                <!--                        <a class="paginator-item" href="#">3</a>-->
                <!--                        <a class="paginator-nav" href="#">-->
                <!--                            <i class="fas fa-arrow-right"></i>-->
                <!--                        </a>-->
                <!--                    </div>-->
                <!--                </div>-->
            </section>
        </div>
        <!--right sidebar-->
        <div class="sidebar section order-lg-last">
            <!--search-->
            <section class="section-sidebar">
                <div class="section-head">
                    <h3 class="section-title h4">
                        <span>搜索菜品</span></h3>
                </div>
                <form autocomplete="off">
                    <div class="row">
                        <div class="col">
                            <div class="input-view-flat input-gray-shadow form-group">
                                <div class="input-group">
                                    <input class="form-control" id="search-keyword" name="search" type="text"
                                           placeholder="今天想吃点什么"
                                           style="color: #9d9d9d" required="required">
                                </div>
                            </div>
                        </div>
                        <div class="col-auto">
                            <button class="mb-0 btn btn-theme" type="button" id="search">
                                <i class="fas fa-search"></i>
                            </button>
                        </div>
                    </div>
                </form>
            </section>
            <!--select type-->
            <section class="section-sidebar">
                <div class="section-head">
                    <h3 class="section-title h4">
                        <span>选择菜系</span></h3>
                </div>
                <ul class="list-unstyled" id="food-type-list">
                    <li>
                        <a class="record-line" href="" onclick="findByType()">
                            <span class="record-title" style="font-size:20px">全部</span>
                        </a>
                    </li>
                    <li>
                        <a class="record-line" href="#">
                            <span class="record-title" style="font-size:20px">粤菜</span>
                        </a>
                    </li>
                    <li>
                        <a class="record-line" href="#">
                            <span class="record-title" style="font-size:20px">川菜</span>
                        </a>
                    </li>
                    <li>
                        <a class="record-line" href="blog-sidebar-right.html">
                            <span class="record-title" style="font-size:20px">杭帮菜</span>
                        </a>
                    </li>

                </ul>
            </section>
        </div>

    </div>
</div>
<div class="scroll-top">
    <i class="fas fa-long-arrow-alt-up"></i>
</div>

<script src="./assets/jquery/jquery-3.3.1.min.js"></script>
<script src="./assets/bootstrap/js/bootstrap.min.js"></script>
<script src="./assets/shuffle/shuffle.min.js"></script>
<script src="./assets/waypoints/jquery.waypoints.min.js"></script>
<script src="./assets/slick/slick.min.js"></script>
<script src="./assets/js-cookie/js.cookie.js" type="text/javascript"></script>
<script src="./assets/js/gmap/silver.js"></script>
<script src="./assets/js/script.js"></script>
<script async defer="defer"
        src="https://ditu.google.cn/maps/api/js?key=AIzaSyBDBAbNXaCDOzujLCykXUvTylfbL1wUcaM&callback=initMap"></script>
<script src="../backend/js/my-utils.js"></script>

<script>

    const reloadTable = function (data) {
        const foodListBox = $("#food-list-box");
        $("#food-list-box > div").remove();
        data.forEach(function (item, index) {
            const price = intToDouble(item.price);
            // const obj = (item.price).toString()+"."+ (item.id).toString()+"."+ item.name;
            const obj = {price:item.price, id:item.id,name :item.name};
            // const obj1 = JSON.stringify(obj);
            // const obj1 = obj.toString();
            const obj1 = JSON.stringify(obj);
            const obj2 = obj1.split("\"").join("");
            console.log(obj2);
            // console.log(obj1.split("\"").join(""));
            foodListBox.append(
                `<div class="col-12 col-lg-6 d-flex">
                    <article class="entity-block entity-hover-shadow">
                        <a class="entity-preview-show-up entity-preview">
                            <span class="embed-responsive embed-responsive-4by3">
                            <img class="embed-responsive-item"
                                 src="https://www.hualigs.cn/image/601ab4cc62191.jpg" alt="">
                            </span>
                        </a>
                        <div class="fill-color-line" data-role="fill-line">
                            <div class="opacity-30 fill-line-segment bg-theme" data-role="fill-line-segment"
                                 data-min-width="10" data-preffered-width="50" data-max-width="80"></div>
                            <div class="opacity-60 fill-line-segment bg-theme" data-role="fill-line-segment"
                                 data-min-width="10" data-preffered-width="50" data-max-width="80"></div>
                            <div class="fill-line-segment bg-theme" data-role="fill-line-segment"
                                 data-min-width="10" data-preffered-width="50" data-max-width="80"></div>
                        </div>
                        <div class="entity-content">
                            <h4 class="entity-title"><a class="content-link" id="${item.id}" name="${obj2}">${item.name}</a></h4>
                            <p class="entity-text">
                                ${item.description}
                            </p>
                            <div class="entity-bottom-line">
                                <div class="entity-price">
                                    <span class="currency">¥</span>${price}
                                </div>
                                <div class="entity-action-btns">
                                    <a class="btn-sm btn btn-theme" href="#" onclick="addCart(${item.id})">加入餐车</a></div>
                            </div>
                        </div>
                    </article>
                </div>`
            );
        })
    };

    const reloadSelect = function (data) {
        const typeList = $("#food-type-list");
        $("#food-type-list > li").remove();
        typeList.append(
            `<li>
                <a class="record-line" href="#" onclick="findByType(0)">
                    <span class="record-title" style="font-size:20px">全部</span>
                </a>
            </li>`
        );
        data.forEach(function (item, index) {
            typeList.append(
                `<li>
                    <a class="record-line" href="#" onclick="findByType(${item.id})" type="button">
                        <span class="record-title" style="font-size:20px">${item.name}</span>
                    </a>
                </li>`
            )
        })
    };

    function findByType(typeId) {
        $.get("/food", {"method": "findByTypeId", "typeId": typeId}, function (data) {
            reloadTable(data);
        }, "json");
    }

    $(function () {
        $.get("/food", function (data) {
            reloadTable(data);
        }, "json");
        $.get("/food-type", function (data) {
            reloadSelect(data);
        }, "json");
    });

    $("#search").click(function () {
        const keyword = $("#search-keyword").val();
        $.get("/food", {"method": "search", "keyword": keyword}, function (data) {
            reloadTable(data);
        }, "json");
    });

    function addCart(id) {
        console.log(id);
        const tdDom = document.getElementById(id);
        const obj = tdDom.getAttribute("name");
        // console.log(JSON.parse(obj));
        //去掉对象字符串两边的大括号
        obj2 = obj.slice(1,-1);
        //将每一个键值对拆分成一个数组
        const result = obj2.split(',');
        const result1 = result.map(item=>{
            //将键值对通过冒号分割，取出键 值
          return  item.split(":")
        });
        //定义一个新的对象用来存储结果
        const objectResult = {}
        result1.forEach(item=>{
            objectResult[item[0] ]= item[1];
        });
        console.log(objectResult);
        // if(localStorage.getItem("result")){
        //     let result = localStorage.getItem("result");
        //     // result.push(objectResult);
           localStorage.setItem("result",result);
        // }

    }



</script>


</body>

</html>